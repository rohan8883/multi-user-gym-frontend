import{c as Y,j as e,D as ye,N as ve,S as ue,O as we,R as De,H as Me,g as S,_ as x}from"./index-CJyZ3len.js";import{C as g}from"./card-INbucF__.js";import{T as Se,a as ke,b as pe,c as fe}from"./tabs-Ja1TL3CJ.js";import{u as be,a as Ye,P as Ae}from"./index-xAMIIVWc.js";import{h as d}from"./moment-BjLXg0w5.js";import{C as je}from"./index-XqQbhP-Y.js";import{d as Ce,r as N,e as Ie}from"./router-Bu5b4_LN.js";import{I as Pe}from"./input-DvRl1kRW.js";import{B as Ee}from"./ButtonLoading-Dh6bV_mB.js";import"./FileUpload-BDeXmpoX.js";import{S as Te}from"./square-pen-BE6GxhL2.js";import{T as ge}from"./trash-D5iRCQ0E.js";import"./axios-DmypytPv.js";import"./select-D1QcyAvF.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=Y("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=Y("MessageSquareMore",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M16 10h.01",key:"1m94wz"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=Y("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),ze=ve("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function k({className:h,variant:y,...p}){return e.jsx("div",{className:ye(ze({variant:y}),h),...p})}function Ze(){var I,P,E,T,$,_,L,z,V,B,R,U,q,O,H,F,W,G,J,K,Q,X,Z,ee,se,te,ae,de,re,ne,le,ie,oe,ce;const h=Ce(),[y,p]=N.useState("0"),{id:o}=Ie(),[v,A]=N.useState(d().toISOString()),[c,w]=N.useState([]),D=be({}),f=be({}),t=Ye({api:`${S.getMember}/${o}`,key:"get-member-detail-view",value:[o],options:{enabled:!!o}}),M=s=>{var a,r,n,i,m,b,j,me,xe;if(s==="paid")return(n=(r=(a=t.data)==null?void 0:a.data)==null?void 0:r.subscription)==null?void 0:n.filter(l=>l.paidStatus==1||l.paidStatus==2).reduce((l,u)=>l+u.paidAmount,0);if(s==="unpaid")return(b=(m=(i=t.data)==null?void 0:i.data)==null?void 0:m.subscription)==null?void 0:b.filter(l=>l.paidStatus==0).reduce((l,u)=>l+u.amount,0);if(s==="due")return(xe=(me=(j=t.data)==null?void 0:j.data)==null?void 0:me.subscription)==null?void 0:xe.filter(l=>l.paidStatus==2).reduce((l,u)=>l+u.dueAmount,0)};N.useEffect(()=>{var s,a,r,n,i,m;if(((r=(a=(s=t.data)==null?void 0:s.data)==null?void 0:a.planMappingId)==null?void 0:r.length)>0){const b=(m=(i=(n=t.data)==null?void 0:n.data)==null?void 0:i.planMappingId)==null?void 0:m.map(j=>j._id);w(b),A("")}},[t.data]);const Ne=async()=>{if(c.length===0)return x.error("Please select at least one plan");je("Are you sure?","Do you want to add or renewal subscription?",async()=>{try{const s=await D.mutateAsync({api:S.createSubscription,data:{memberId:o,subscriptionData:c==null?void 0:c.map(a=>({planMappingId:a})),customStartDate:v??d().toISOString()}});s.data.success?(x.success(s.data.message),t.refetch()):x.error(s.data.message)}catch{x.error("Something went wrong")}})},C=async s=>{je("Are you sure!","Do you want to delete this subscription?",async()=>{try{const a=await f.mutateAsync({api:S.subDeleteById,data:{id:s}});a.data.success?(x.success(a.data.message),t.refetch()):x.error(a.data.message)}catch{x.error("Something went wrong")}})};return t.isLoading?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(ue,{})}):e.jsxs(Ae,{title:"View Member",children:[e.jsxs(g,{className:"mt-4 p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-10 gap-y-3",children:[e.jsx("div",{className:"flex gap-3 col-span-2",children:(E=(P=(I=t.data)==null?void 0:I.data)==null?void 0:P.planMappingId)==null?void 0:E.map((s,a)=>e.jsx("div",{children:e.jsxs(k,{className:"bg-secondary text-primary",children:[s.plan,e.jsxs("small",{className:"text-xs font-semibold text-primary",children:["(",s.month,"month)"]})]})},a+1))}),e.jsx("div",{className:"border-t border-secondary  col-span-2"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Member Name"}),e.jsx("h1",{className:"text-xs font-semibold",children:($=(T=t.data)==null?void 0:T.data)==null?void 0:$.memberName})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Member ID"}),e.jsx("h1",{className:"text-xs font-semibold",children:(L=(_=t.data)==null?void 0:_.data)==null?void 0:L.generatedId})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Mobile"}),e.jsx("h1",{className:"text-xs font-semibold",children:(V=(z=t.data)==null?void 0:z.data)==null?void 0:V.mobile})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Date of Birth"}),e.jsx("h1",{className:"text-xs font-semibold",children:d((R=(B=t.data)==null?void 0:B.data)==null?void 0:R.dob).format("DD-MMM-YYYY")})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Weight"}),e.jsx("h1",{className:"text-xs font-semibold",children:(q=(U=t.data)==null?void 0:U.data)==null?void 0:q.weight})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex justify-center gap-6 items-center",children:[e.jsx(Le,{className:"h-6 w-6 text-green-600",onClick:()=>{var s,a;return window.open(`tel:${(a=(s=t.data)==null?void 0:s.data)==null?void 0:a.mobile}`)}}),e.jsx(_e,{className:"h-6 w-6 text-blue-600",onClick:()=>{var s,a,r,n;return window.open(`sms:${(a=(s=t.data)==null?void 0:s.data)==null?void 0:a.mobile}`,`sms:${(n=(r=t.data)==null?void 0:r.data)==null?void 0:n.mobile}`)}}),e.jsx(we,{onClick:()=>{var s,a;window.open(`https://wa.me/${(a=(s=t.data)==null?void 0:s.data)==null?void 0:a.mobile}`)},src:"/whatsapp.svg",alt:"whatsapp",width:24,height:24}),e.jsx(De,{className:"h-6 w-6 text-primary",onClick:()=>{h(`/gym-app/receipt-list?member-id=${o}`)}}),e.jsx($e,{className:"h-6 w-6 ",onClick:()=>{h(`/gym-app/member-gym-id/${o}`)}}),e.jsx(Te,{className:"h-6 w-6 text-red-700",onClick:()=>{h(`/gym-app/update-member/${o}`)}})]})})]}),e.jsx("div",{className:"border-t border-secondary mt-4"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-4",children:[e.jsxs("div",{className:"text-green-700",children:[e.jsx("h1",{className:"text-xs font-semibold",children:"Total Paid"}),e.jsx("h1",{className:"text-sm font-semibold",children:M("paid")})]}),e.jsxs("div",{className:"text-blue-700",children:[e.jsx("h1",{className:"text-xs font-semibold",children:"Total Due"}),e.jsx("h1",{className:"text-sm font-semibold",children:M("due")})]}),e.jsxs("div",{className:"text-red-700",children:[e.jsx("h1",{className:"text-xs font-semibold ",children:"Total Unpaid"}),e.jsx("h1",{className:"text-sm font-semibold",children:M("unpaid")})]})]})]}),e.jsx("div",{className:"border-t border-secondary mt-3"}),e.jsx(g,{className:"mt-4 p-4",children:f!=null&&f.isPending?e.jsx("div",{className:"flex justify-center items-center h-16",children:e.jsx(ue,{})}):e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Choose Renewal Date"}),e.jsx(Pe,{type:"date",value:v?d(v).format("YYYY-MM-DD"):d().format("YYYY-MM-DD"),onChange:s=>A(s.target.value),placeholder:"Enter Custom Date"})]}),e.jsx("div",{className:"col-span-2 flex gap-3",children:(F=(H=(O=t.data)==null?void 0:O.data)==null?void 0:H.planMappingId)==null?void 0:F.map((s,a)=>e.jsx("div",{className:"flex gap-12 mr-4",children:e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",checked:c.includes(s._id),onChange:r=>{r.target.checked?w([...c,s._id]):w(c.filter(n=>n!==s._id))}})," ",e.jsx("label",{className:"font-bold text-xs text-muted-foreground",htmlFor:"plan",children:s.plan})]})},a+1))}),((J=(G=(W=t.data)==null?void 0:W.data)==null?void 0:G.subscription)==null?void 0:J.length)>0&&e.jsx("div",{children:e.jsx(Me,{size:"sm",className:"bg-primary text-white w-full",onClick:()=>{h(`/gym-app/payment/${o}`)},children:"Proceed Payment"})}),e.jsx("div",{className:`
              ${((X=(Q=(K=t.data)==null?void 0:K.data)==null?void 0:Q.subscription)==null?void 0:X.length)>0?"col-span-1":"col-span-2"}
              `,children:e.jsx(Ee,{isLoading:D.isPending,disabled:D.isPending,size:"sm",className:"bg-red-900 text-white w-full hover:bg-red-800",onClick:Ne,children:((se=(ee=(Z=t.data)==null?void 0:Z.data)==null?void 0:ee.subscription)==null?void 0:se.length)>0?"Renew Subscription":"Add Subscription"})})]})}),e.jsx("div",{className:"border-t border-secondary mt-6"}),((de=(ae=(te=t.data)==null?void 0:te.data)==null?void 0:ae.subscription)==null?void 0:de.length)>0?e.jsxs(Se,{defaultValue:y,className:"w-full ",children:[e.jsxs(ke,{className:"w-full overflow-x-scroll h-8",children:[e.jsx(pe,{className:"w-full text-xs",value:"0",onClick:()=>{p("0")},children:"Current Subscription"}),e.jsx(pe,{className:"w-full text-xs",value:"2",onClick:()=>{p("2")},children:"All Subscription"})]}),e.jsx(fe,{value:"0",className:"text-muted-foreground font-semibold",children:(le=(ne=(re=t==null?void 0:t.data)==null?void 0:re.data)==null?void 0:ne.subscription)==null?void 0:le.map(s=>{var a,r,n;return(n=(r=(a=t.data)==null?void 0:a.data)==null?void 0:r.ExpStatus)==null?void 0:n.map(i=>{if(i.subsId===s._id)return e.jsxs(g,{className:"mt-2 p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(k,{className:"bg-secondary text-primary",children:[s.planName,e.jsx("span",{className:"ml-1"}),e.jsxs("small",{className:"text-xs font-semibold text-primary",children:["(",s.month," month)"]})]}),d(s.endDate).diff(d(),"days")+1<=0?e.jsx("span",{className:"text-red-500 text-xs font-semibold",children:"Expired"}):e.jsx("span",{className:"text-green-500 text-xs font-semibold",children:d(s.endDate).diff(d(),"days")+1+" days left"}),s.paidStatus===0&&e.jsx(ge,{className:"h-4 w-4 cursor-pointer text-red-600",onClick:()=>C(s._id)})]}),e.jsx("div",{className:"border-t border-secondary mt-3 mb-1"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2.5",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Start Date"}),e.jsx("h1",{className:"text-xs font-semibold",children:d(s.startDate).format("DD-MMM-YYYY")})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"End Date"}),e.jsx("h1",{className:"text-xs font-semibold",children:d(s.endDate).format("DD-MMM-YYYY")})]}),e.jsx("div",{className:"border-t border-secondary  col-span-4"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Amount"}),e.jsx("h1",{className:"text-xs font-semibold",children:s.amount})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Paid"}),e.jsx("h1",{className:"text-xs font-semibold",children:s.paidAmount})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Due"}),e.jsx("h1",{className:"text-xs font-semibold",children:s.dueAmount})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Status"}),s.paidStatus===0&&e.jsx("small",{className:"text-red-600 font-bold text-xs",children:"UNPAID"})||s.paidStatus===1&&e.jsx("small",{className:"text-green-600 font-bold text-xs",children:"PAID"})||s.paidStatus===2&&e.jsx("small",{className:"text-blue-600 font-bold text-xs",children:"DUE"})]})]})]},i.subsId)})})}),e.jsx(fe,{value:"2",className:"text-muted-foreground font-semibold",children:(ce=(oe=(ie=t.data)==null?void 0:ie.data)==null?void 0:oe.subscription)==null?void 0:ce.map((s,a)=>{var r,n,i;return e.jsxs(g,{className:"mt-2 p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(k,{className:"bg-secondary text-primary",children:[s.planName,e.jsx("span",{className:"ml-1"}),e.jsxs("small",{className:"text-xs font-semibold text-primary",children:["(",s.month," month)"]})]}),(i=(n=(r=t==null?void 0:t.data)==null?void 0:r.data)==null?void 0:n.ExpStatus)!=null&&i.find(m=>m.subsId==s._id)?d(s.endDate).diff(d(),"days")+1<=0?e.jsx("span",{className:"text-red-500 text-xs font-semibold",children:"Expired"}):e.jsx("span",{className:"text-green-500 text-xs font-semibold",children:d(s.endDate).diff(d(),"days")+1+" days left"}):e.jsx("span",{className:"text-blue-500 text-xs font-semibold",children:"Old Subscription"}),s.paidStatus==0&&e.jsx(ge,{className:"h-4 w-4 cursor-pointer text-red-600",onClick:()=>C(s._id)})]}),e.jsx("div",{className:"border-t border-secondary mt-3 mb-1"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2.5",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Start Date"}),e.jsx("h1",{className:"text-xs font-semibold",children:d(s.startDate).format("DD-MMM-YYYY")})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"End Date"}),e.jsx("h1",{className:"text-xs font-semibold",children:d(s.endDate).format("DD-MMM-YYYY")})]}),e.jsx("div",{className:"border-t border-secondary  col-span-4"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Amount"}),e.jsx("h1",{className:"text-xs font-semibold",children:s==null?void 0:s.amount})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Paid"}),e.jsx("h1",{className:"text-xs font-semibold",children:s==null?void 0:s.paidAmount})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Due"}),e.jsx("h1",{className:"text-xs font-semibold",children:s.dueAmount})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xs font-semibold text-muted-foreground",children:"Status"}),s.paidStatus===0&&e.jsx("small",{className:"text-red-600 font-bold text-xs",children:"UNPAID"})||s.paidStatus===1&&e.jsx("small",{className:"text-green-600 font-bold text-xs",children:"PAID"})||s.paidStatus===2&&e.jsx("small",{className:"text-blue-600 font-bold text-xs",children:"DUE"})]})]})]},a+1)})})]}):e.jsx("div",{className:"flex justify-center items-center h-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-sm  font-semibold text-muted-foreground",children:"No Subscription Found!"}),e.jsx("small",{className:"text-xs font-semibold text-muted-foreground",children:"Please add new subscription."})]})})]})}export{Ze as default};
