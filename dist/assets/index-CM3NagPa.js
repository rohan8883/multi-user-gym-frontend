import{j as s,g as u,_ as n,B as P,S as L}from"./index-DkZWIdXg.js";import{P as F}from"./index-6TWfaeyW.js";import{r as m}from"./router-Bu5b4_LN.js";import{h as T}from"./moment-BjLXg0w5.js";import{C as $,a as E,d as k,b as I}from"./card-Cg18XrSq.js";import{T as _,a as z,b as w,c as N,d as H,e as b}from"./table-hJIwGfXr.js";import{u as R}from"./FileUpload-YQfoUfq_.js";import{F as Y,R as D,c as q,a as G}from"./RHFTextField-sohbxKOu.js";import{o as J}from"./yup-DLhudBoB.js";import{B as K}from"./ButtonLoading-p7T3Si2p.js";import"./input-BVNq6uLW.js";import{S as A}from"./separator-DEs-pywx.js";import{D as O}from"./index-CYBuAJj4.js";import{u as Q,b as C,a as B}from"./useCustomQuery-BHfm9GW-.js";import{S as U}from"./index-CxMmNlNd.js";import"./axios-DmypytPv.js";import"./select-DBN7CKYv.js";const V=q().shape({planName:G().required("Month name is required")});function W({open:S,setOpen:h,title:v,id:p,edit:r,setEdit:x,refetch:y}){const f=Q({}),j=C({}),{data:e,isFetching:M}=B({api:`${u.getPlanById}/${p}`,options:{enabled:r}}),i=R({resolver:J(V)}),g=async c=>{var l,o,d,a;try{if(r&&c){const t=await j.mutateAsync({api:`${u.updatePlanById}/${p}`,data:c});(l=t.data)!=null&&l.success?n.success((o=t==null?void 0:t.data)==null?void 0:o.message):n.error(t.data.message)}else{const t=await f.mutateAsync({api:u.createPlan,data:c});(d=t.data)!=null&&d.success?n.success((a=t==null?void 0:t.data)==null?void 0:a.message):n.error("Month not created successfully"),i.reset({planName:""})}h(!1),x(!1),y()}catch{}};return m.useEffect(()=>{r&&e?i.reset({planName:e.data.planName}):i.reset({planName:""})},[r,e]),s.jsx(O,{open:S,setOpen:h,title:v,setEdit:x,edit:r,isLoading:M,children:s.jsx(Y,{methods:i,onSubmit:i.handleSubmit(g),children:s.jsxs("div",{className:"gap-y-4 gap-x-2 grid grid-cols-1",children:[s.jsx("div",{children:s.jsx(D,{name:"planName",placeholder:"Enter plan name"})}),s.jsx(A,{}),s.jsx("div",{children:s.jsx(K,{size:"sm",isLoading:i.formState.isSubmitting,type:"submit",className:"w-full",children:"Submit"})})]})})})}function X(){var g,c,l,o,d;const S=C({}),[h,v]=m.useState(""),[p,r]=m.useState(!1),[x,y]=m.useState(""),[f,j]=m.useState(!1),e=B({api:`${(g=u)==null?void 0:g.getAllPlans}`,key:"planList",options:{enabled:!0}}),M=a=>{j(!0),r(!0),y(a)},i=async a=>{try{const t=await S.mutateAsync({api:`${u.updatePlanStatusById}/${a}`});t.data.success?(n.success(t.data.message),e.refetch()):n.error(t.data.message)}catch{n.error("Something went wrong")}};return s.jsxs("main",{className:"grid items-start",children:[s.jsx(W,{open:p,setOpen:r,title:f?"Edit Month":"Add Month",id:x,edit:f,setEdit:j,refetch:e.refetch}),s.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[s.jsxs("div",{className:"flex justify-between w-full gap-2",children:[s.jsx("div",{children:s.jsx(U,{search:h,setSearch:v,refetch:e.refetch,isFetching:e.isLoading})}),s.jsx("div",{children:s.jsx(P,{size:"sm",className:"flex items-center gap-2",onClick:()=>r(!0),children:"Add New"})})]}),s.jsxs($,{className:"w-full overflow-scroll",children:[s.jsx(E,{className:"px-7",children:s.jsxs(k,{children:["Total Month: ",(l=(c=e==null?void 0:e.data)==null?void 0:c.data)==null?void 0:l.length]})}),s.jsx(I,{children:e.isLoading?s.jsx("div",{className:"flex justify-center items-center h-32",children:s.jsx(L,{})}):s.jsxs(s.Fragment,{children:[s.jsxs(_,{children:[s.jsx(z,{children:s.jsxs(w,{children:[s.jsx(N,{className:"",children:"PLan Name"}),s.jsx(N,{className:"",children:"Created at"}),s.jsx(N,{className:"",children:"Status"}),s.jsx(N,{className:"text-center",children:"Action"})]})}),s.jsx(H,{children:(d=(o=e==null?void 0:e.data)==null?void 0:o.data)==null?void 0:d.map(a=>s.jsxs(w,{children:[s.jsx(b,{children:a.planName}),s.jsx(b,{children:T(a.createdAt).format("DD-MM-YYYY")}),s.jsx(b,{children:a.status==1?"Active":"Inactive"}),s.jsx(b,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(P,{size:"sm",className:"bg-primary",onClick:()=>M(a._id),children:"Edit"}),s.jsx(P,{size:"sm",className:a.status==1?"bg-destructive":"bg-green-700",onClick:()=>i(a._id),children:a.status==1?"Deactivate":"Activate"})]})})]},a._id))})]}),s.jsx(A,{className:"mt-4 mb-2"})]})})]})]})]})}function fs(){return s.jsx(F,{title:"Plan List",children:s.jsx("div",{className:" mt-3 mb-2",children:s.jsx(X,{})})})}export{fs as default};
